---
title: "Amazon Product Analysis"
authors: 'Nathan Thomas, Benjamin Tuohey, Ivan Voinov'
output: html_notebook
---



# Importing/Cleaning Data
```{r}
Amazon_Products <- read.csv('Amazon_Products.csv')
head(Amazon_Products)
```

## Cleaning Data
```{r}
colnames(Amazon_Products)
```

### Removes 800+ empty columns - filters down to 14
```{r}
Amazon_Products_Cleaned <- subset(Amazon_Products, select = c(uniq_id, product_name, manufacturer, price, number_available_in_stock, number_of_reviews, number_of_answered_questions, average_review_rating, amazon_category_and_sub_category, description, product_information, product_description, items_customers_buy_after_viewing_this_item, customer_questions_and_answers))
```

```{r}
head(Amazon_Products_Cleaned)
```

### Writes Dataset as CSV for export
```{r}
write.csv(Amazon_Products_Cleaned,'Amazon_Products_Cleaned.csv')
```

### Convert Price from Pound to Dollar and variable transformation

Price is currently character, need to remove the pound symbol and convert to float type
```{r}
Amazon_Products_Cleaned$price<-gsub("Â£","",as.character(Amazon_Products_Cleaned$price))
```

```{r}
library(tidyverse)
Amazon_Products_Cleaned <- Amazon_Products_Cleaned %>%
  mutate(price = as.numeric(as.character(Amazon_Products_Cleaned$price)), 
         number_of_reviews = as.numeric(number_of_reviews),
         number_of_answered_questions = as.numeric(number_of_answered_questions))
Amazon_Products_Cleaned$price <- Amazon_Products_Cleaned$price*1.30
```

### Convert review rating to number

```{r}
Amazon_Products_Cleaned$average_review_rating <- substr(Amazon_Products_Cleaned$average_review_rating,1,3)
Amazon_Products_Cleaned <- Amazon_Products_Cleaned %>%
  mutate(average_review_rating = as.numeric(average_review_rating))
  
```


# Initial Statistics/Plots
## Statistics

```{r}
Amazon_Products_Cleaned %>%
  summarise(num_cases = n(), 
            mean_price = mean(price, na.rm=T),
            med_price = median(price, na.rm=T),
            mean_reviews = mean(number_of_reviews, na.rm=T),
            mean_rating = mean(average_review_rating, na.rm=T)
            )
```

## Manufacturer Analysis

```{r}
Dis_Manufacturer <- Amazon_Products_Cleaned %>% 
  group_by(manufacturer) %>%
  filter(n() >= 1)
```

Here we see there are 2654 unique manufacturers in our data. 
```{r}
n_distinct(Dis_Manufacturer$manufacturer)
```


For our analysis, we consider big manufacturer those that have 50 or more products listed.
```{r}
Big_Manufacturer <- Amazon_Products_Cleaned %>% 
  group_by(manufacturer) %>%
  filter(n() >= 50)
```

We observe that there are 24 manufacturers that have 50 or more product listings.
```{r}
n_distinct(Big_Manufacturer$manufacturer)
```
Manufacturer Distribution
```{r}
counts <- table(Big_Manufacturer$manufacturer)
barplot(counts, las = 2,
        cex.names = 0.7,main="Manufacturer Distribution", ylab = "Number of Product Listings")
```

Sorted Distribution
```{r}
barplot(sort(counts, decreasing = TRUE), las = 2,
        cex.names = 0.7,main="Manufacturer Distribution", ylab = "Number of Product Listings")
```


## Plots
###Boxplot
```{r}
Amazon_Products_Cleaned %>%
  ggplot(aes(y=price)) +
  geom_boxplot()
```
There are a lot of outliers, let's adjust the scale.

```{r}
Amazon_Products_Cleaned %>%
  ggplot(aes(y=price)) +
  geom_boxplot() +
  ylim(0,25)
```
Density Plot of Price Distribution (Skewed to the right)
```{r}
ggplot(data = Amazon_Products_Cleaned, aes(x = price)) + geom_density(fill = 'cyan')
```



# Clustering
### Looking for groups

```{r}
# pairs can only look at numeric variables
Amazon_Products_Cleaned_numeric <- Amazon_Products_Cleaned %>%
  select(price, number_of_reviews, number_of_answered_questions, average_review_rating)
pairs(Amazon_Products_Cleaned_numeric)
```

# Linear Regression

```{r}
model1 <- lm(price ~ ., data = Amazon_Products_Cleaned_numeric)
summary(model1)
```
